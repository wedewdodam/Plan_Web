@page "/Plan_Report/Year_Practice_Report"
@using Microsoft.AspNetCore.ProtectedBrowserStorage
@inject ProtectedSessionStorage ProtectedSessionStore

<div class="card">
    <div class="card-header">
        <table width="100%">
            <tr>
                <td>
                    <span style="font-size: 1em"> <span class="bi-house-fill"></span>&nbsp;<span style="font-size: 1em; color:Highlight; font-weight: bold">장기수선계획 연차별 계획표</span></span>
                </td>
                <td>
                </td>
                <td align="right">
                    <button type="button" class="btn btn-primary btn-sm" @onclick="btnPrint"><span class="bi-box-arrow-in-right"> &nbsp; 인쇄</span></button>
                </td>
            </tr>
        </table>
    </div>
    <div class="card-body">
        <table style="width: 100%; font-size: 0.9em">
            <tr>
                <td style="vertical-align:middle">
                    시작년도로부터 5년까지만 선택할 수 있습니다.
                </td>
                <td style="width: 250px">
                    <div class="input-group">
                        <div class="input-group-prepend"><span class="input-group-text" style="font-size: 0.9em"><span class="bi-pencil-square"></span>&nbsp;시작년도</span></div>
                        <input id="strStartYear" name="strStartYear" style="font-size: 0.9em; text-align:center" @bind="strStartYear" class="form-control" type="text" readonly="readonly" />
                        <div class="input-group-append"><span class="input-group-text" style="font-size: 0.9em"><span class="bi-pencil-square"></span>&nbsp;년부터</span></div>
                    </div>
                </td>
                <td style="width: 50px; text-align:center">
                    ~
                </td>
                <td style="width: 350px">
                    <div class="input-group">
                        <div class="input-group-prepend"><span class="input-group-text" style="font-size: 0.9em"><span class="bi-pencil-square"></span>&nbsp;종료년도</span></div>
                        <select id="SmallSum_Unit" class="custom-select text-center" style="font-size: 0.9em; width: 100px" value="@strEndYear" @onchange="OnSelect" required>
                            <option value="Z">=선택=</option>                            
                            <option value="2021">2021</option>
                            <option value="2022">2022</option>
                            <option value="2023">2023</option>
                            <option value="2024">2024</option>
                            <option value="2025">2025</option>
                            <option value="2026">2026</option>
                            <option value="2027">2027</option>
                            <option value="2028">2028</option>
                            <option value="2029">2029</option>
                            <option value="2030">2030</option>
                            <option value="2031">2031</option>
                            <option value="2032">2032</option>
                            <option value="2033">2033</option>
                            <option value="2034">2034</option>
                            <option value="2035">2035</option>
                            <option value="2036">2036</option>
                            <option value="2037">2037</option>
                            <option value="2038">2038</option>
                            <option value="2039">2039</option>
                            <option value="2040">2040</option>
                            <option value="2041">2041</option>
                            <option value="2042">2042</option>
                            <option value="2043">2043</option>
                            <option value="2044">2044</option>
                            <option value="2045">2045</option>
                            <option value="2046">2046</option>
                            <option value="2047">2047</option>
                            <option value="2048">2048</option>
                            <option value="2049">2049</option>
                            <option value="2050">2050</option>
                            <option value="2051">2051</option>
                            <option value="2052">2052</option>
                            <option value="2053">2053</option>
                            <option value="2054">2054</option>
                            <option value="2055">2055</option>
                            <option value="2056">2056</option>
                            <option value="2057">2057</option>
                            <option value="2058">2058</option>
                            <option value="2059">2059</option>
                            <option value="2060">2060</option>
                            <option value="2061">2061</option>
                            <option value="2062">2062</option>
                            <option value="2063">2063</option>
                            <option value="2064">2064</option>
                            <option value="2065">2065</option>
                            <option value="2066">2066</option>
                            <option value="2067">2067</option>
                            <option value="2068">2068</option>
                            <option value="2069">2069</option>
                            <option value="2070">2070</option>
                            <option value="2071">2071</option>
                            <option value="2072">2072</option>
                            <option value="2073">2073</option>
                            <option value="2074">2074</option>
                            <option value="2075">2075</option>
                            <option value="2076">2076</option>
                            <option value="2077">2077</option>
                            <option value="2078">2078</option>
                            <option value="2079">2079</option>
                            <option value="2080">2080</option>
                            <option value="2081">2081</option>
                            <option value="2082">2082</option>
                            <option value="2083">2083</option>
                            <option value="2084">2084</option>
                            <option value="2085">2085</option>
                            <option value="2086">2086</option>
                            <option value="2087">2087</option>
                            <option value="2088">2088</option>
                            <option value="2089">2089</option>
                            <option value="2090">2090</option>
                            <option value="2091">2091</option>
                            <option value="2092">2092</option>
                            <option value="2093">2093</option>
                            <option value="2094">2094</option>
                            <option value="2095">2095</option>
                            <option value="2096">2096</option>
                            <option value="2097">2097</option>
                            <option value="2098">2098</option>
                            <option value="2099">2099</option>
                            <option value="2100">2100</option>
                            <option value="2101">2101</option>
                            <option value="2102">2102</option>
                            <option value="2103">2103</option>
                            <option value="2104">2104</option>
                            <option value="2105">2105</option>
                            <option value="2106">2106</option>
                            <option value="2107">2107</option>
                            <option value="2108">2108</option>
                            <option value="2109">2109</option>
                            <option value="2110">2110</option>
                            <option value="2111">2111</option>
                            <option value="2112">2112</option>
                            <option value="2113">2113</option>
                            <option value="2114">2114</option>
                            <option value="2115">2115</option>
                            <option value="2116">2116</option>
                            <option value="2117">2117</option>
                            <option value="2118">2118</option>
                            <option value="2119">2119</option>
                            <option value="2120">2120</option>
                        </select>
                        <div class="input-group-append"><span class="input-group-text" style="font-size: 0.9em"><span class="bi-pencil-square"></span>&nbsp;년 까지 검색</span></div>
                    </div>
                </td>
               
            </tr>
        </table>
        @if (ann.Count == 0)
        {
            <p style="text-align:center">
                <img src="/images/loader.gif" height="70" />
            </p>
        }
        else if (ann == null)
        {
            <p style="text-align:center">
                정보가 없습니다.
            </p>
        }
        else
        {
            <table class="table table-sm" style="font-size: 0.8em">
                <thead>
                    <tr style="background-color: whitesmoke">
                        <th class="text-center" rowspan="2" style="width: 30%; vertical-align:middle">
                            수선항목
                        </th>
                        <th style="text-align:center; vertical-align:middle">
                            전체주기(법정/설정/현재)
                        </th>
                        <th style="text-align:center; vertical-align:middle">
                            부분주기(법정/설정/현재)/수선율
                        </th>
                        <th style="text-align:center; vertical-align:middle">
                            최종 전체수선년도
                        </th>
                        <th style="text-align:center; vertical-align:middle">
                            수량(면적)
                        </th>
                    </tr>
                    <tr style="background-color: whitesmoke">
                       
                        <th style="text-align:center; vertical-align:middle">
                            전체수선금액
                        </th>
                        <th style="text-align:center; vertical-align:middle">
                            부분수선금액
                        </th>
                        <th style="text-align:center; vertical-align:middle">
                            최종 부분수선년도
                        </th>
                        <th style="text-align:center; vertical-align:middle">
                            수선예정년도(전체/부분)
                        </th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var st in ann)
                    {
                        <tr>
                            <td style="text-align:center; vertical-align:middle" rowspan="4">
                                @st.Sort_A_Name <span class="bi-chevron-double-right"></span> @st.Sort_B_Name <span class="bi-chevron-double-right"></span> @st.Sort_C_Name <span class="bi-chevron-double-right"></span> @st.Repair_Article_Name
                            </td>
                            <td style="text-align:center; vertical-align:middle">
                                @st.Law_Repair_Cycle_All<span>년</span> <span class="bi-chevron-double-right"></span> @st.All_Cycle<span>년</span> <span class="bi-chevron-double-right"></span> @st.Set_Repair_Cycle_All<span>년</span>
                            </td>
                            <td style="text-align:center; vertical-align:middle">
                                @st.Law_Repair_Cycle_Part<span>년</span> <span class="bi-chevron-double-right"></span> @st.Part_Cycle<span>년</span> <span class="bi-chevron-double-right"></span> @st.Set_Repair_Cycle_Part<span>년</span> <span class="bi-chevron-double-right"></span> @st.Repair_Rate<span>%</span>
                            </td>
                            <td style="text-align:center; vertical-align:middle">
                                @if (st.All_Cycle > 0)
                                {
                                    @st.Installation.Year.ToString()<span>년</span>
                                }
                                else
                                {
                                    <span>없음</span>
                                }

                            </td>
                            <td style="text-align:center; vertical-align:middle">
                                @string.Format("{0: ###,###.#}", st.Amount)<span>@st.Unit</span>
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; background-color: whitesmoke">
                                수선항목설명 :
                            </td>
                            <td style="text-align: center; vertical-align: middle" colspan="3">
                                @if (st.Repair_Article_Etc == "")
                                {
                                    <span>없음</span>
                                }
                                else
                                {
                                    @((MarkupString)st.Repair_Article_Etc)
                                }

                            </td>
                        </tr>
                        <tr>
                            
                            <td style="text-align:center; vertical-align:middle">
                                @if (st.All_Cycle > 0)
                                {
                                    @string.Format("{0: ###,###.#}", st.Repair_All_Cost)<span>원</span>
                                }
                                else
                                {
                                    <span>0원</span>
                                }
                            </td>
                            <td style="text-align:center; vertical-align:middle">
                                @if (st.Part_Cycle > 0)
                                {
                                    @string.Format("{0: ###,###.#}", st.Repair_Part_Cost)<span>원</span>
                                }
                                else
                                {
                                    <span>0원</span>
                                }

                            </td>
                            <td style="text-align:center; vertical-align:middle">
                                @if (st.Part_Cycle > 0)
                                {
                                    @st.Installation_Part.Year.ToString()<span>년</span>
                                }
                                else
                                {
                                    <span>없음</span>
                                }

                            </td>
                            <td style="text-align:center; vertical-align:middle">
                                @if (st.All_Cycle > 0)
                                {
                                    <span style="color: red">@st.Repair_Plan_Year_All<span>년</span></span><span>(</span>@(st.Repair_Plan_Year_All + st.All_Cycle)<span>년)</span>
                                }
                                else
                                {
                                    <span>0년</span>
                                }<span>/</span>
                                @if (st.Part_Cycle > 0)
                                {
                                    <span style="color: red">@st.Repair_Plan_Year_Part<span>년</span></span><span>(</span>@(st.Repair_Plan_Year_Part + st.Part_Cycle)<span>년)</span>
                                }
                                else
                                {
                                    <span>0년</span>
                                }

                            </td>
                        </tr>
                        <tr>
                            <td style="text-align:center; vertical-align:middle; background-color: whitesmoke">
                                수선금액설명 :
                            </td>
                            <td style="text-align:center; vertical-align:middle" colspan="3">
                                @if (st.Cost_Etc == "")
                                {
                                    <span>없음</span>
                                }
                                else
                                {
                                    @((MarkupString)st.Cost_Etc)
                                }

                            </td>
                        </tr>
                    }
                    <tr>
                        <td style="text-align: right; vertical-align: middle" colspan="5">
                            <span style="font-weight:bold">
                                총합계 : @string.Format("{0: ###,###.#}", rpp.Plan_cost)<span>원</span> &nbsp; &nbsp; &nbsp; 전체수선항목 수 : @rpp.All_Year_Count<span>개</span> &nbsp; &nbsp; &nbsp; 전체수선금액 합계 : @string.Format("{0: ###,###.#}", rpp.All_Cost)<span>원</span> &nbsp; &nbsp; &nbsp; 전체수선항목 수 : @rpp.Part_Year_Count<span>개</span> &nbsp; &nbsp; &nbsp; 전체수선금액 합계 : @string.Format("{0: ###,###.#}", rpp.Part_Cost)<span>원</span>
                            </span>
                        </td>
                    </tr>
                </tbody>

            </table>
        }
        </div>
</div>