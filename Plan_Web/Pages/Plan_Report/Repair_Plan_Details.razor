@page "/Plan_Report/Repair_Plan_Details"
@using Microsoft.AspNetCore.ProtectedBrowserStorage
@inject ProtectedSessionStorage ProtectedSessionStore

    <div class="card">
        <div class="card-header">
            <table width="100%">
                <tr>
                    <td>
                        <span style="font-size: 1em"> <span class="bi-house-fill"></span>&nbsp;<span style="font-size: 1em; color:Highlight; font-weight: bold">장기수선계획 상세표</span></span>
                    </td>
                    <td>
                    </td>
                    <td align="right">
                        <button type="button" class="btn btn-primary btn-sm" @onclick="btnPrint"><span class="bi-box-arrow-in-right"> &nbsp; 인쇄</span></button>
                    </td>
                </tr>
            </table>
        </div>
        <div class="card-body">

            @if (ann1.Count == 0)
            {
                <p style="text-align:center">
                    <img src="/images/loader.gif" height="70" />
                </p>
            }
            else if (ann1 == null)
            {
                <p style="text-align:center">
                    정보가 없습니다.
                </p>
            }
            else
            {
                <img src="/images/sub/icon_con_tit.png" alt="" /> <span style="font-size: 0.9em; font-weight:bold"> 1. 건물외부 (@ann1.Count<span>개</span>)</span>
                <table class="table table-sm" style="font-size: 0.8em">
                    <thead>
                        <tr style="background-color:whitesmoke">
                            <th style="text-align:center">
                                수선항목 명
                            </th>
                            <th style="text-align:center" title="법정주기, 설정주기, 첫 주기, 전체수선예정년도 순으로 표시됩니다.">
                                구 분
                            </th>
                            <th style="text-align:center" title="법정주기, 설정주기, 첫 주기, 부분수선예정년도 순으로 표시됩니다.">
                                횟 수
                            </th>
                            <th style="text-align:center">
                                최종수선
                            </th>
                            <th style="text-align:center">
                                수선주기
                            </th>
                            <th style="text-align:center">
                                수선예정년도
                            </th>
                            <th style="text-align:center">
                                수선금액
                            </th>
                            <th style="text-align:center">
                                수선율
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var st in ann1)
                        {
                            <tr>
                                <td style="text-align: center; vertical-align:middle; width: 25%" rowspan="3">
                                    @st.Sort_B_Name <span class="bi-chevron-double-right"></span> @st.Sort_C_Name <span class="bi-chevron-double-right"></span> @st.Repair_Article_Name
                                </td>
                                <td style="text-align: center; background-color: whitesmoke">
                                    전체
                                </td>
                                <td style="text-align: center">
                                    @st.All_Cycle_Num<span>회</span>
                                </td>
                                <td style="text-align: center">
                                    @if (st.Installation.Year > 0)
                                    {
                                        @st.Installation.Year.ToString()<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (st.Set_Repair_Cycle_All > 0)
                                    {
                                        @st.Set_Repair_Cycle_All<span>년</span>
                                    }
                                    else
                                    {
                                        <span>0년</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Set_Repair_Cycle_All > 0)
                                    {
                                        @st.Repair_Plan_Year_All<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Set_Repair_Cycle_All > 0)
                                    {
                                        @string.Format("{0: ###,###.#}", st.Repair_All_Cost)<span>원</span>
                                    }
                                    else
                                    {
                                        <span>0원</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    <span>100%</span>
                                </td>
                            </tr>
                            <tr>

                                <td style="text-align: center; background-color: whitesmoke">
                                    부분
                                </td>
                                <td style="text-align: center">
                                    @st.Part_Cycle_Num<span>회</span>
                                </td>
                                <td style="text-align: center">
                                    @if (st.Installation_Part.Year > 0)
                                    {
                                        @st.Installation_Part.Year.ToString()<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (st.Set_Repair_Cycle_Part > 0)
                                    {
                                        @st.Set_Repair_Cycle_Part<span>년</span>
                                    }
                                    else
                                    {
                                        <span>0년</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Repair_Rate > 0)
                                    {
                                        @st.Repair_Plan_Year_Part<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Repair_Rate > 0)
                                    {
                                        @string.Format("{0: ###,###.#}", st.Repair_Part_Cost)<span>원</span>
                                    }
                                    else
                                    {
                                        <span>0원</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @st.Repair_Rate<span>%</span>
                                </td>
                            </tr>
                            <tr style="border-bottom:solid; border-bottom-color: cornflowerblue; border-bottom-width: 1px">

                                <td style="text-align: center; vertical-align: middle; background-color: whitesmoke">
                                    비고
                                </td>
                                <td style="text-align: center" colspan="6">
                                    @st.Repair_Article_Etc ▶ @st.Cost_Etc
                                </td>
                            </tr>
                        }
                        <tr>
                            <td colspan="8" style="text-align:right; font-weight: bold">
                                전체수선금액 : @string.Format("{0: ###,###.#}", @AllCost1)<span>원</span> &nbsp; &nbsp; &nbsp; 부분수선금액 : @string.Format("{0: ###,###.#}", @PartCost1)<span>원</span> &nbsp; &nbsp; &nbsp;
                            </td>
                        </tr>
                    </tbody>
                </table>

                <img src="/images/sub/icon_con_tit.png" alt="" /> <span style="font-size: 0.9em; font-weight:bold"> 2. 건물내부 (@ann2.Count<span>개</span>)</span>
                <table class="table table-sm" style="font-size: 0.8em">
                    <thead>
                        <tr style="background-color:whitesmoke">
                            <th style="text-align:center">
                                수선항목 명
                            </th>
                            <th style="text-align:center" title="법정주기, 설정주기, 첫 주기, 전체수선예정년도 순으로 표시됩니다.">
                                구 분
                            </th>
                            <th style="text-align:center" title="법정주기, 설정주기, 첫 주기, 부분수선예정년도 순으로 표시됩니다.">
                                횟 수
                            </th>
                            <th style="text-align:center">
                                최종수선
                            </th>
                            <th style="text-align:center">
                                수선주기
                            </th>
                            <th style="text-align:center">
                                수선예정년도
                            </th>
                            <th style="text-align:center">
                                수선금액
                            </th>
                            <th style="text-align:center">
                                수선율
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var st in ann2)
                        {
                            <tr>
                                <td style="text-align: center; vertical-align:middle; width: 25%" rowspan="3">
                                    @st.Sort_B_Name <span class="bi-chevron-double-right"></span> @st.Sort_C_Name <span class="bi-chevron-double-right"></span> @st.Repair_Article_Name
                                </td>
                                <td style="text-align: center; background-color: whitesmoke">
                                    전체
                                </td>
                                <td style="text-align: center">
                                    @st.All_Cycle_Num<span>회</span>
                                </td>
                                <td style="text-align: center">
                                    @if (st.Installation.Year > 0)
                                    {
                                        @st.Installation.Year.ToString()<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (st.Set_Repair_Cycle_All > 0)
                                    {
                                        @st.Set_Repair_Cycle_All<span>년</span>
                                    }
                                    else
                                    {
                                        <span>0년</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Set_Repair_Cycle_All > 0)
                                    {
                                        @st.Repair_Plan_Year_All<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Set_Repair_Cycle_All > 0)
                                    {
                                        @string.Format("{0: ###,###.#}", st.Repair_All_Cost)<span>원</span>
                                    }
                                    else
                                    {
                                        <span>0원</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    <span>100%</span>
                                </td>
                            </tr>
                            <tr>

                                <td style="text-align: center; background-color: whitesmoke">
                                    부분
                                </td>
                                <td style="text-align: center">
                                    @st.Part_Cycle_Num<span>회</span>
                                </td>
                                <td style="text-align: center">
                                    @if (st.Installation_Part.Year > 0)
                                    {
                                        @st.Installation_Part.Year.ToString()<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (st.Set_Repair_Cycle_Part > 0)
                                    {
                                        @st.Set_Repair_Cycle_Part<span>년</span>
                                    }
                                    else
                                    {
                                        <span>0년</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Repair_Rate > 0)
                                    {
                                        @st.Repair_Plan_Year_Part<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Repair_Rate > 0)
                                    {
                                        @string.Format("{0: ###,###.#}", st.Repair_Part_Cost)<span>원</span>
                                    }
                                    else
                                    {
                                        <span>0원</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @st.Repair_Rate<span>%</span>
                                </td>
                            </tr>
                            <tr style="border-bottom:solid; border-bottom-color: cornflowerblue; border-bottom-width: 1px">

                                <td style="text-align: center; vertical-align:middle; background-color: whitesmoke">
                                    비고
                                </td>
                                <td style="text-align: center" colspan="6">
                                    @st.Repair_Article_Etc ▶ @st.Cost_Etc
                                </td>
                            </tr>
                        }
                        <tr>
                            <td colspan="8" style="text-align:right; font-weight: bold">
                                전체수선금액 : @string.Format("{0: ###,###.#}", @AllCost2)<span>원</span> &nbsp; &nbsp; &nbsp; 부분수선금액 : @string.Format("{0: ###,###.#}", @PartCost2)<span>원</span> &nbsp; &nbsp; &nbsp;
                            </td>
                        </tr>
                    </tbody>
                </table>


                <img src="/images/sub/icon_con_tit.png" alt="" /> <span style="font-size: 0.9em; font-weight:bold"> 3. 전기·소화·승강기 및 지능형 홈네트워크 설비 (@ann3.Count<span>개</span>)</span>
                <table class="table table-sm" style="font-size: 0.8em">
                    <thead>
                        <tr style="background-color:whitesmoke">
                            <th style="text-align:center">
                                수선항목 명
                            </th>
                            <th style="text-align:center" title="법정주기, 설정주기, 첫 주기, 전체수선예정년도 순으로 표시됩니다.">
                                구 분
                            </th>
                            <th style="text-align:center" title="법정주기, 설정주기, 첫 주기, 부분수선예정년도 순으로 표시됩니다.">
                                횟 수
                            </th>
                            <th style="text-align:center">
                                최종수선
                            </th>
                            <th style="text-align:center">
                                수선주기
                            </th>
                            <th style="text-align:center">
                                수선예정년도
                            </th>
                            <th style="text-align:center">
                                수선금액
                            </th>
                            <th style="text-align:center">
                                수선율
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var st in ann3)
                        {
                            <tr>
                                <td style="text-align: center; vertical-align:middle; width: 25%" rowspan="3">
                                    @st.Sort_B_Name <span class="bi-chevron-double-right"></span> @st.Sort_C_Name <span class="bi-chevron-double-right"></span> @st.Repair_Article_Name
                                </td>
                                <td style="text-align: center; background-color: whitesmoke">
                                    전체
                                </td>
                                <td style="text-align: center">
                                    @st.All_Cycle_Num<span>회</span>
                                </td>
                                <td style="text-align: center">
                                    @if (st.Installation.Year > 0)
                                    {
                                        @st.Installation.Year.ToString()<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (st.Set_Repair_Cycle_All > 0)
                                    {
                                        @st.Set_Repair_Cycle_All<span>년</span>
                                    }
                                    else
                                    {
                                        <span>0년</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Set_Repair_Cycle_All > 0)
                                    {
                                        @st.Repair_Plan_Year_All<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Set_Repair_Cycle_All > 0)
                                    {
                                        @string.Format("{0: ###,###.#}", st.Repair_All_Cost)<span>원</span>
                                    }
                                    else
                                    {
                                        <span>0원</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    <span>100%</span>
                                </td>
                            </tr>
                            <tr>

                                <td style="text-align: center; background-color: whitesmoke">
                                    부분
                                </td>
                                <td style="text-align: center">
                                    @st.Part_Cycle_Num<span>회</span>
                                </td>
                                <td style="text-align: center">
                                    @if (st.Installation_Part.Year > 0)
                                    {
                                        @st.Installation_Part.Year.ToString()<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (st.Set_Repair_Cycle_Part > 0)
                                    {
                                        @st.Set_Repair_Cycle_Part<span>년</span>
                                    }
                                    else
                                    {
                                        <span>0년</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Repair_Rate > 0)
                                    {
                                        @st.Repair_Plan_Year_Part<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Repair_Rate > 0)
                                    {
                                        @string.Format("{0: ###,###.#}", st.Repair_Part_Cost)<span>원</span>
                                    }
                                    else
                                    {
                                        <span>0원</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @st.Repair_Rate<span>%</span>
                                </td>
                            </tr>
                            <tr style="border-bottom:solid; border-bottom-color: cornflowerblue; border-bottom-width: 1px">

                                <td style="text-align: center; vertical-align: middle; background-color: whitesmoke">
                                    비고
                                </td>
                                <td style="text-align: center" colspan="6">
                                    @st.Repair_Article_Etc ▶ @st.Cost_Etc
                                </td>
                            </tr>
                        }
                        <tr>
                            <td colspan="8" style="text-align:right; font-weight: bold">
                                전체수선금액 : @string.Format("{0: ###,###.#}", @AllCost3)<span>원</span> &nbsp; &nbsp; &nbsp; 부분수선금액 : @string.Format("{0: ###,###.#}", @PartCost3)<span>원</span> &nbsp; &nbsp; &nbsp;
                            </td>
                        </tr>
                    </tbody>
                </table>

                <img src="/images/sub/icon_con_tit.png" alt="" /> <span style="font-size: 0.9em; font-weight:bold"> 4. 급수·배수 및 환기설비 (@ann4.Count<span>개</span>)</span>
                <table class="table table-sm" style="font-size: 0.8em">
                    <thead>
                        <tr style="background-color:whitesmoke">
                            <th style="text-align:center">
                                수선항목 명
                            </th>
                            <th style="text-align:center" title="법정주기, 설정주기, 첫 주기, 전체수선예정년도 순으로 표시됩니다.">
                                구 분
                            </th>
                            <th style="text-align:center" title="법정주기, 설정주기, 첫 주기, 부분수선예정년도 순으로 표시됩니다.">
                                횟 수
                            </th>
                            <th style="text-align:center">
                                최종수선
                            </th>
                            <th style="text-align:center">
                                수선주기
                            </th>
                            <th style="text-align:center">
                                수선예정년도
                            </th>
                            <th style="text-align:center">
                                수선금액
                            </th>
                            <th style="text-align:center">
                                수선율
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var st in ann4)
                        {
                            <tr>
                                <td style="text-align: center; vertical-align:middle; width: 25%" rowspan="3">
                                    @st.Sort_B_Name <span class="bi-chevron-double-right"></span> @st.Sort_C_Name <span class="bi-chevron-double-right"></span> @st.Repair_Article_Name
                                </td>
                                <td style="text-align: center; background-color: whitesmoke">
                                    전체
                                </td>
                                <td style="text-align: center">
                                    @st.All_Cycle_Num<span>회</span>
                                </td>
                                <td style="text-align: center">
                                    @if (st.Installation.Year > 0)
                                    {
                                        @st.Installation.Year.ToString()<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (st.Set_Repair_Cycle_All > 0)
                                    {
                                        @st.Set_Repair_Cycle_All<span>년</span>
                                    }
                                    else
                                    {
                                        <span>0년</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Set_Repair_Cycle_All > 0)
                                    {
                                        @st.Repair_Plan_Year_All<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Set_Repair_Cycle_All > 0)
                                    {
                                        @string.Format("{0: ###,###.#}", st.Repair_All_Cost)<span>원</span>
                                    }
                                    else
                                    {
                                        <span>0원</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    <span>100%</span>
                                </td>
                            </tr>
                            <tr>

                                <td style="text-align: center; background-color: whitesmoke">
                                    부분
                                </td>
                                <td style="text-align: center">
                                    @st.Part_Cycle_Num<span>회</span>
                                </td>
                                <td style="text-align: center">
                                    @if (st.Installation_Part.Year > 0)
                                    {
                                        @st.Installation_Part.Year.ToString()<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (st.Set_Repair_Cycle_Part > 0)
                                    {
                                        @st.Set_Repair_Cycle_Part<span>년</span>
                                    }
                                    else
                                    {
                                        <span>0년</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Repair_Rate > 0)
                                    {
                                        @st.Repair_Plan_Year_Part<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Repair_Rate > 0)
                                    {
                                        @string.Format("{0: ###,###.#}", st.Repair_Part_Cost)<span>원</span>
                                    }
                                    else
                                    {
                                        <span>0원</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @st.Repair_Rate<span>%</span>
                                </td>
                            </tr>
                            <tr style="border-bottom:solid; border-bottom-color: cornflowerblue; border-bottom-width: 1px">

                                <td style="text-align: center; vertical-align: middle; background-color: whitesmoke ">
                                    비고
                                </td>
                                <td style="text-align: center" colspan="6">
                                    @st.Repair_Article_Etc ▶ @st.Cost_Etc
                                </td>
                            </tr>
                        }
                        <tr>
                            <td colspan="8" style="text-align:right; font-weight: bold">
                                전체수선금액 : @string.Format("{0: ###,###.#}", @AllCost4)<span>원</span> &nbsp; &nbsp; &nbsp; 부분수선금액 : @string.Format("{0: ###,###.#}", @PartCost4)<span>원</span> &nbsp; &nbsp; &nbsp;
                            </td>
                        </tr>
                    </tbody>
                </table>

                <img src="/images/sub/icon_con_tit.png" alt="" /> <span style="font-size: 0.9em; font-weight:bold"> 5. 난방 및 급탕설비 (@ann5.Count<span>개</span>)</span>
                <table class="table table-sm" style="font-size: 0.8em">
                    <thead>
                        <tr style="background-color:whitesmoke">
                            <th style="text-align:center">
                                수선항목 명
                            </th>
                            <th style="text-align:center" title="법정주기, 설정주기, 첫 주기, 전체수선예정년도 순으로 표시됩니다.">
                                구 분
                            </th>
                            <th style="text-align:center" title="법정주기, 설정주기, 첫 주기, 부분수선예정년도 순으로 표시됩니다.">
                                횟 수
                            </th>
                            <th style="text-align:center">
                                최종수선
                            </th>
                            <th style="text-align:center">
                                수선주기
                            </th>
                            <th style="text-align:center">
                                수선예정년도
                            </th>
                            <th style="text-align:center">
                                수선금액
                            </th>
                            <th style="text-align:center">
                                수선율
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var st in ann5)
                        {
                            <tr>
                                <td style="text-align: center; vertical-align:middle; width: 25%" rowspan="3">
                                    @st.Sort_B_Name <span class="bi-chevron-double-right"></span> @st.Sort_C_Name <span class="bi-chevron-double-right"></span> @st.Repair_Article_Name
                                </td>
                                <td style="text-align: center; background-color: whitesmoke">
                                    전체
                                </td>
                                <td style="text-align: center">
                                    @st.All_Cycle_Num<span>회</span>
                                </td>
                                <td style="text-align: center">
                                    @if (st.Installation.Year > 0)
                                    {
                                        @st.Installation.Year.ToString()<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (st.Set_Repair_Cycle_All > 0)
                                    {
                                        @st.Set_Repair_Cycle_All<span>년</span>
                                    }
                                    else
                                    {
                                        <span>0년</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Set_Repair_Cycle_All > 0)
                                    {
                                        @st.Repair_Plan_Year_All<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Set_Repair_Cycle_All > 0)
                                    {
                                        @string.Format("{0: ###,###.#}", st.Repair_All_Cost)<span>원</span>
                                    }
                                    else
                                    {
                                        <span>0원</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    <span>100%</span>
                                </td>
                            </tr>
                            <tr>

                                <td style="text-align: center; background-color: whitesmoke">
                                    부분
                                </td>
                                <td style="text-align: center">
                                    @st.Part_Cycle_Num<span>회</span>
                                </td>
                                <td style="text-align: center">
                                    @if (st.Installation_Part.Year > 0)
                                    {
                                        @st.Installation_Part.Year.ToString()<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (st.Set_Repair_Cycle_Part > 0)
                                    {
                                        @st.Set_Repair_Cycle_Part<span>년</span>
                                    }
                                    else
                                    {
                                        <span>0년</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Repair_Rate > 0)
                                    {
                                        @st.Repair_Plan_Year_Part<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Repair_Rate > 0)
                                    {
                                        @string.Format("{0: ###,###.#}", st.Repair_Part_Cost)<span>원</span>
                                    }
                                    else
                                    {
                                        <span>0원</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @st.Repair_Rate<span>%</span>
                                </td>
                            </tr>
                            <tr style="border-bottom:solid; border-bottom-color: cornflowerblue; border-bottom-width: 1px">

                                <td style="text-align: center; vertical-align: middle; background-color: whitesmoke">
                                    비고
                                </td>
                                <td style="text-align: center" colspan="6">
                                    @st.Repair_Article_Etc ▶ @st.Cost_Etc
                                </td>
                            </tr>
                        }
                        <tr>
                            <td colspan="8" style="text-align:right; font-weight: bold">
                                전체수선금액 : @string.Format("{0: ###,###.#}", @AllCost5)<span>원</span> &nbsp; &nbsp; &nbsp; 부분수선금액 : @string.Format("{0: ###,###.#}", @PartCost5)<span>원</span> &nbsp; &nbsp; &nbsp;
                            </td>
                        </tr>
                    </tbody>
                </table>

                <img src="/images/sub/icon_con_tit.png" alt="" /> <span style="font-size: 0.9em; font-weight:bold"> 6. 옥외 복리시설 및 옥외 부대시설 (@ann6.Count<span>개</span>)</span>
                <table class="table table-sm" style="font-size: 0.8em">
                    <thead>
                        <tr style="background-color:whitesmoke">
                            <th style="text-align:center">
                                수선항목 명
                            </th>
                            <th style="text-align:center" title="법정주기, 설정주기, 첫 주기, 전체수선예정년도 순으로 표시됩니다.">
                                구 분
                            </th>
                            <th style="text-align:center" title="법정주기, 설정주기, 첫 주기, 부분수선예정년도 순으로 표시됩니다.">
                                횟 수
                            </th>
                            <th style="text-align:center">
                                최종수선
                            </th>
                            <th style="text-align:center">
                                수선주기
                            </th>
                            <th style="text-align:center">
                                수선예정년도
                            </th>
                            <th style="text-align:center">
                                수선금액
                            </th>
                            <th style="text-align:center">
                                수선율
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var st in ann6)
                        {
                            <tr>
                                <td style="text-align: center; vertical-align:middle; width: 25%" rowspan="3">
                                    @st.Sort_B_Name <span class="bi-chevron-double-right"></span> @st.Sort_C_Name <span class="bi-chevron-double-right"></span> @st.Repair_Article_Name
                                </td>
                                <td style="text-align: center; background-color: whitesmoke">
                                    전체
                                </td>
                                <td style="text-align: center">
                                    @st.All_Cycle_Num<span>회</span>
                                </td>
                                <td style="text-align: center">
                                    @if (st.Installation.Year > 0)
                                    {
                                        @st.Installation.Year.ToString()<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (st.Set_Repair_Cycle_All > 0)
                                    {
                                        @st.Set_Repair_Cycle_All<span>년</span>
                                    }
                                    else
                                    {
                                        <span>0년</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Set_Repair_Cycle_All > 0)
                                    {
                                        @st.Repair_Plan_Year_All<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Set_Repair_Cycle_All > 0)
                                    {
                                        @string.Format("{0: ###,###.#}", st.Repair_All_Cost)<span>원</span>
                                    }
                                    else
                                    {
                                        <span>0원</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    <span>100%</span>
                                </td>
                            </tr>
                            <tr>

                                <td style="text-align: center; background-color: whitesmoke">
                                    부분
                                </td>
                                <td style="text-align: center">
                                    @st.Part_Cycle_Num<span>회</span>
                                </td>
                                <td style="text-align: center">
                                    @if (st.Installation_Part.Year > 0)
                                    {
                                        @st.Installation_Part.Year.ToString()<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (st.Set_Repair_Cycle_Part > 0)
                                    {
                                        @st.Set_Repair_Cycle_Part<span>년</span>
                                    }
                                    else
                                    {
                                        <span>0년</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Repair_Rate > 0)
                                    {
                                        @st.Repair_Plan_Year_Part<span>년</span>
                                    }
                                    else
                                    {
                                        <span>없음</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @if (@st.Repair_Rate > 0)
                                    {
                                        @string.Format("{0: ###,###.#}", st.Repair_Part_Cost)<span>원</span>
                                    }
                                    else
                                    {
                                        <span>0원</span>
                                    }

                                </td>
                                <td style="text-align: center">
                                    @st.Repair_Rate<span>%</span>
                                </td>
                            </tr>
                            <tr style="border-bottom:solid; border-bottom-color: cornflowerblue; border-bottom-width: 1px">

                                <td style="text-align: center; vertical-align: middle; background-color: whitesmoke">
                                    비고
                                </td>
                                <td style="text-align: center" colspan="6">
                                    @st.Repair_Article_Etc ▶ @st.Cost_Etc
                                </td>
                            </tr>
                        }
                        <tr>
                            <td colspan="8" style="text-align:right; font-weight: bold">
                                전체수선금액 : @string.Format("{0: ###,###.#}", @AllCost6)<span>원</span> &nbsp; &nbsp; &nbsp; 부분수선금액 : @string.Format("{0: ###,###.#}", @PartCost6)<span>원</span> &nbsp; &nbsp; &nbsp;
                            </td>
                        </tr>
                    </tbody>
                </table>
            }

        </div>
    </div>